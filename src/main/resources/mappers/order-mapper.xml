<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="orderMapper">
<resultMap type="com.study.bookspace.adminOrder.vo.GoodsOrderVO" id="order">
	<id  	column="ORDER_CODE"  			property="orderCode" />
	<result  column="BUY_DATE"  				property="buyDate" />
	<result  column="MEM_ID"  				property="memId" />
	<result  column="ORDER_NO"  			property="orderNo" />
	<result  column="BUY_PRICE"  			property="buyPrice" />
</resultMap>

<insert id="insertOrder">
	INSERT INTO GOODS_ORDER (
		ORDER_CODE
		, BUY_DATE
		, MEM_ID
		, ORDER_NO
		, BUY_PRICE
	) VALUES (
		(SELECT 'ORDER_' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(ORDER_CODE, 7))), 0) + 1, 3, '0') AS ORDER_CODE
			FROM GOODS_ORDER)
			, #{buyDate}
			, #{memId}
			, #{orderNo}
			, #{buyPrice}
	)
</insert>

<select id="selectOrder" resultMap="order">
	SELECT ORDER_CODE
		, BUY_DATE
		, MEM_ID
		, ORDER_NO
		, BUY_PRICE
	FROM GOODS_ORDER
	ORDER BY BUY_DATE DESC
</select>

<update id="updateOrder">
	UPDATE GOODS_ORDER
	SET ORDER_NO =#{orderNo}
	WHERE ORDER_CODE = #(orderCode)
</update>
	
	
	
	
</mapper>
