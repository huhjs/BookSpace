<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="goodsMapper">

	<resultMap type="com.study.bookspace.goods.vo.GoodsCategoryVO" id="goodsCategory">
		<id		 column="GOODS_CATE_CODE"  				property="goodsCateCode"  />
		<result column="GOODS_CATE_NAME" 				property="goodsCateName"  />
		<result column="GOODS_CATE_ORDER_NO"  		property="goodsCateOrderNo"  />
		<result column="GOODS_CATE_IS_USE"  			property="goodsCateIsUse"  />
	</resultMap>
	
	<resultMap type="com.study.bookspace.goods.vo.GoodsVO" id="goods">
		<id		 column="GOODS_CODE"					property="goodsCode"/>
		<result column="GOODS_CATE_CODE"			property="goodsCateCode"/>
		<result column="GOODS_NAME"					property="goodsName"/>
		<result column="GOODS_PRICE"					property="goodsPrice"/>
		<result column="GOODS_STOCK_CNT"			property="goodsStockCnt"/>
		<result column="GOODS_INTRO"					property="goodsIntro"/>
		<result column="GOODS_STATUS"				property="goodsStatus"/>
		<result column="GOODS_STATUS_STR"		property="goodsStatusStr"/>
		<association property="goodsCategoryVO" 	resultMap="goodsCategory"></association>
		<collection property="goodsImgList"   			resultMap="goodsImg" ></collection>
	</resultMap>
	
	<resultMap type="com.study.bookspace.goods.vo.GoodsImgVO" id="goodsImg">
		<id  column="GOODS_IMG_CODE"  				property="goodsImgCode"/>
		<result  column="ORIGIN_FILE_NAME"  		property="originFileName"/>
		<result  column="ATTACHED_FILE_NAME"  	property="attachedFileName"/>
		<result  column="IS_MAIN"  							property="isMain"/>
		<result  column="GOODS_CODE"  				property="goodsCode"/>
	</resultMap>
	
	<!-- 굿즈 카테고리 관리페이지에서 목록 조회(관리자) -->
	<select id="selectGoodsCateList" resultMap="goodsMapper.goodsCategory">
		SELECT GOODS_CATE_CODE
			, GOODS_CATE_NAME
			, GOODS_CATE_ORDER_NO
			, GOODS_CATE_IS_USE
		FROM GOODS_CATEGORY
	</select>
	
	<!--굿즈 카테고리 등록 (관리자) -->
	<insert id="insertGoodsCategory">
		INSERT INTO GOODS_CATEGORY (
			GOODS_CATE_CODE
			, GOODS_CATE_NAME
			, GOODS_CATE_ORDER_NO
		) VALUES (
			(SELECT 'GOODS_CATE_' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(GOODS_CATE_CODE, 11))), 0) + 1, 3, '0')
			FROM GOODS_CATEGORY)
			, #{goodsCateName}
			, #{goodsCateOrderNo}
		)
	</insert>
	

	
	
	
</mapper>
