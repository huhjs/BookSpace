<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{fragment/member_layout}">

<!--연결해야 할 외부 css파일  -->
<th:block layout:fragment="content_css">
	<!--<link rel="stylesheet" href=""> -->
	<style>
		.buy-title{
			margin-right: 1rem;
		}
		.buy-index{
			font-size: 1.1rem;
			font-weight: bold;
		}
	</style>
</th:block>

<th:block layout:fragment="content">
<a th:href="@{/mCart/cartList}">장바구니</a>
   <div class="row">
		<div class="col">
			<div class="row mb-3">
			구매 이력
			</div>
			<div class="row">
				<div class="col">
					<div class="accordion" id="accordionPanelsStayOpenExample">
					  <th:block th:each="buy, state : ${buyList}">
						  <div class="accordion-item">
						    <h2 class="accordion-header">
						      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
						      th:data-bs-target="${'#panel_' + state.count}" 
						      aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
						        <span class="buy-title buy-index">[[${#numbers.formatInteger(#lists.size(buyList) - state.index, 2)}]] | </span>
						        <span class="buy-title">구매일시 [[${buy.buyDate}]]</span>
						        <span class="buy-title">구매금액 [[${#numbers.formatCurrency(buy.buyPrice)}]]</span>
						        <span class="buy-title">
						        	구매내역 [[${buy.buyDetailList[0].goodsVO.goodsName}]]
							        <th:blcok th:if="${buy.etc >= 2}">
							        	외 [[${buy.etc - 1}]]건
							        </th:blcok>
							    </span>
						      </button>
						    </h2>
						    <div th:id="${'panel_' + state.count}" class="accordion-collapse collapse">
						      <div class="accordion-body">
								<table class="table text-center align-middle">
									<colgroup>
										<col width="">
										<col width="">
										<col width="">
										<col width="">
										<col width="">
										<col width="">
									</colgroup>
									<thead>
										<tr>
											<td>No</td>
											<td>상품정보</td>
											<td>가 격</td>
											<td>수 량</td>
											<td>구매가격</td>
											<td>배송 상태</td>
										</tr>
									</thead>
									<tbody>
										<tr th:each="buyDetail, detailState : ${buy.buyDetailList}">
											<td>[[${#lists.size(buy.buyDetailList) - detailState.index}]]</td>
											<td class="text-start">
												<img width="70px" th:src="${'/image/goods/' + buyDetail.goodsVO.goodsImgList[0].attachedFileName}">
												[[${buyDetail.goodsVO.goodsName}]]
											</td>
											<td>[[${#numbers.formatCurrency(buyDetail.goodsVO.goodsPrice)}]]</td>
											<td>[[${buyDetail.buyDetailCnt}]]</td>
											<td>[[${#numbers.formatCurrency(buyDetail.buyDetailPrice)}]]</td>
											<td th:text="${buy.orderStr}">
											</td>
										</tr>
									</tbody>
								</table>
						      </div>
						    </div>
						  </div>
					  </th:block>
					</div>
				</div>
			</div>
		</div>
	</div>
</th:block>

<!--연결해야 할 외부 js 파일  -->
<th:block layout:fragment="content_js">
	<script type="text/javascript" src="/js/content/buy/buy_list.js"></script>
</th:block>

</html>